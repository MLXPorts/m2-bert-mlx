Curator's note: Prefer the human-authored MLX guides for clarity. - ../docs\\\\\\\_curated/README.md - ../docs\\\\\\\_curated/PYTORCH\\\\\\\_DISSONANCE.md - ../docs\\\\\\\_curated/NUMPY\\\\\\\_USERS.md - ../docs\\\\\\\_curated/COMMON\\\\\\\_PITFALLS.md \\\\## Curated Notes - Ensure your \\\\\\\`find\\\\\\\_package(MLX CONFIG REQUIRED)\\\\\\\` (or equivalent) points to the installed MLX C++ package; set \\\\\\\`CMAKE\\\\\\\_PREFIX\\\\\\\_PATH\\\\\\\` if needed. - Link against the MLX targets provided by the package (e.g., \\\\\\\`target\\\\\\\_link\\\\\\\_libraries(example PRIVATE mlx::mlx)\\\\\\\` if exported). - On non‑Metal builds (CPU‑only), guard GPU‑dependent code with availability checks to keep the binary portable across hosts. \\\[\\\](https://github.com/ml-explore/mlx "Source repository")\\\\- \\\[.rst\\\](https://ml-explore.github.io/mlx/build/html/\\\_sources/dev/mlx\\\_in\\\_cpp.rst "Download source file") - .pdf # Using MLX in C++ # Using MLX in C++ You can use MLX in a C++ project with CMake. Note This guide is based one the following \\\[example using MLX in C++\\\](https://github.com/ml-explore/mlx/tree/main/examples/cmake\\\_project) First install MLX: \\\`\\\`\\\`bash pip install -U mlx \\\`\\\`\\\` You can also install the MLX Python package from source or just the C++ library. For more information see the \\\[documentation on installing MLX\\\](https://ml-explore.github.io/mlx/build/html/install.html#build-and-install). Next make an example program in \\\`\\\\\\\`example.cpp\\\\\\\`\\\`: \\\`\\\`\\\`c++ #include #include "mlx/mlx.h" namespace mx = mlx::core; int main() { auto x = mx::array({1, 2, 3}); auto y = mx::array({1, 2, 3}); std::cout << x + y << std::endl; return 0; } \\\`\\\`\\\` The next step is to setup a CMake file in \\\`\\\\\\\`CMakeLists.txt\\\\\\\`\\\`: \\\`\\\`\\\`cmake cmake\\\_minimum\\\_required(VERSION 3.27) project(example LANGUAGES CXX) set(CMAKE\\\_CXX\\\_STANDARD 17) set(CMAKE\\\_CXX\\\_STANDARD\\\_REQUIRED ON) \\\`\\\`\\\` Depending on how you installed MLX, you may need to tell CMake where to find it. If you installed MLX with Python, then add the following to the CMake file: \\\`\\\`\\\`cmake find\\\_package( Python 3.9 COMPONENTS Interpreter Development.Module REQUIRED) execute\\\_process( COMMAND "${Python\\\_EXECUTABLE}" -m mlx --cmake-dir OUTPUT\\\_STRIP\\\_TRAILING\\\_WHITESPACE OUTPUT\\\_VARIABLE MLX\\\_ROOT) \\\`\\\`\\\` If you installed the MLX C++ package to a system path, then CMake should be able to find it. If you installed it to a non-standard location or CMake can’t find MLX then set \\\`\\\\\\\`MLX\\\\\\\_ROOT\\\\\\\`\\\` to the location where MLX is installed: \\\`\\\`\\\`cmake set(MLX\\\_ROOT "/path/to/mlx/") \\\`\\\`\\\` Next, instruct CMake to find MLX: \\\`\\\`\\\`cmake find\\\_package(MLX CONFIG REQUIRED) \\\`\\\`\\\` Finally, add the \\\`\\\\\\\`example.cpp\\\\\\\`\\\` program as an executable and link MLX. \\\`\\\`\\\`cmake add\\\_executable(example example.cpp) target\\\_link\\\_libraries(example PRIVATE mlx) \\\`\\\`\\\` You can build the example with: \\\`\\\`\\\`bash cmake -B build -DCMAKE\\\_BUILD\\\_TYPE=Release cmake --build build \\\`\\\`\\\` And run it with: \\\`\\\`\\\`bash ./build/example \\\`\\\`\\\` Note \\\`\\\\\\\`find\\\\\\\_package(MLX\\\\\\\`\\\`\\\\\\\` \\\\\\\`\\\`\\\\\\\`CONFIG\\\\\\\`\\\`\\\\\\\` \\\\\\\`\\\`\\\\\\\`REQUIRED)\\\\\\\`\\\` sets the following variables: | Variable | Description | |----|----| | MLX\\\\\\\_FOUND | \\\`\\\\\\\`True\\\\\\\`\\\` if MLX is found | | MLX\\\\\\\_INCLUDE\\\\\\\_DIRS | Include directory | | MLX\\\\\\\_LIBRARIES | Libraries to link against | | MLX\\\\\\\_CXX\\\\\\\_FLAGS | Additional compiler flags | | MLX\\\\\\\_BUILD\\\\\\\_ACCELERATE | \\\`\\\\\\\`True\\\\\\\`\\\` if MLX was built with Accelerate | | MLX\\\\\\\_BUILD\\\\\\\_METAL | \\\`\\\\\\\`True\\\\\\\`\\\` if MLX was built with Metal | Package Variables {#id1} \\\[\\\](https://ml-explore.github.io/mlx/build/html/dev/custom\\\_metal\\\_kernels.html "previous page") previous Custom Metal Kernels By MLX Contributors © Copyright 2023, MLX Contributors.

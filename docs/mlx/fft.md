Curator's note: Prefer the human-authored MLX guides for clarity. - ../docs\\\\\\\_curated/README.md - ../docs\\\\\\\_curated/PYTORCH\\\\\\\_DISSONANCE.md - ../docs\\\\\\\_curated/NUMPY\\\\\\\_USERS.md - ../docs\\\\\\\_curated/COMMON\\\\\\\_PITFALLS.md \\\\## Curated Notes - Real transforms (\\\\\\\`rfft\\\\\\\*\\\\\\\`) produce complex outputs with Hermitian symmetry; match \\\\\\\`irfft\\\\\\\*\\\\\\\` shapes accordingly (\\\\\\\`n\\\\\\\` controls length). - Multi‑axis transforms: specify \\\\\\\`axes=(...)\\\\\\\` explicitly to avoid surprises. - Use \\\\\\\`.real\\\\\\\`/\\\\\\\`.imag\\\\\\\` to extract components; keep dtypes consistent when post‑processing. Backend note: Some builds support FFT on CPU only. If your GPU backend errors, run FFTs on the CPU using the \\\\\\\`stream\\\\\\\` parameter (or a CPU device scope) and keep the rest of the pipeline on GPU. MLX ops generally do not take a \\\\\\\`device=\\\\\\\` parameter; use default device/streams instead. ### CPU Stream Example \\\\\\\`\\\\\\\`\\\\\\\`python import mlx.core as mx # Unified memory: accessible by both CPU and GPU a = mx.random.uniform(shape=(16,)) # Perform FFT and iFFT explicitly on CPU fft\\\\\\\_cpu = mx.fft.fft(a, stream=mx.cpu) ifft\\\\\\\_cpu = mx.fft.ifft(fft\\\\\\\_cpu, stream=mx.cpu) \\\\\\\`\\\\\\\`\\\\\\\` ### Global Default Device Example \\\\\\\`\\\\\\\`\\\\\\\`python import mlx.core as mx # Route subsequent ops to CPU globally mx.set\\\\\\\_default\\\\\\\_device(mx.cpu) a = mx.random.uniform(shape=(16,)) fft\\\\\\\_result = mx.fft.fft(a) # runs on CPU due to default device # Reset later if desired # mx.set\\\\\\\_default\\\\\\\_device(mx.gpu) \\\\\\\`\\\\\\\`\\\\\\\` ## Potential Issues - Mixed‑device streams: If you use both CPU and GPU streams, MLX tracks dependencies. When a GPU op consumes results from a CPU op (or vice‑versa), MLX ensures the producer completes first. You generally don’t need to add manual barriers beyond \\\\\\\`mx.synchronize()\\\\\\\` at host boundaries. - Performance implications: GPUs typically accelerate large FFTs substantially. For small inputs, CPU can be competitive and unified memory helps avoid transfer overhead. Benchmark both paths at your problem sizes. - Numerical stability: Certain FFT‑based pipelines may exhibit numerical instability in specific configurations. If you see unexpected results, try alternate precisions (e.g., float32), different batching/tiling, or switch device backends to isolate the effect while MLX improvements land. ### Examples \\\\\\\`\\\\\\\`\\\\\\\`python import mlx.core as mx # 1D FFT and inverse sig = mx.random.normal((1024,)) spec = mx.fft.fft(sig) recon = mx.fft.ifft(spec).real # Real-input transforms r = mx.random.normal((256,)) R = mx.fft.rfft(r) r\\\\\\\_back = mx.fft.irfft(R, n=r.shape\\\\\\\[0\\\\\\\]) # 2D FFT over specified axes img = mx.random.normal((64, 64)) F = mx.fft.fft2(img) img\\\\\\\_back = mx.fft.ifft2(F).real # N-D with custom axes vol = mx.random.normal((8, 16, 32)) G = mx.fft.fftn(vol, axes=(1, 2)) \\\\\\\`\\\\\\\`\\\\\\\` \\\[\\\](https://github.com/ml-explore/mlx "Source repository")\\\\- \\\[.rst\\\](https://ml-explore.github.io/mlx/build/html/\\\_sources/python/fft.rst "Download source file") - .pdf # FFT # FFT | | | |----|----| | \\\[\\\`\\\`fft\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fft.fft.html#mlx.core.fft.fft "mlx.core.fft.fft")(a\\\\\\\\\\\\\\\[, n, axis, stream\\\\\\\\\\\\\\\]) | One dimensional discrete Fourier Transform. | | \\\[\\\`\\\`ifft\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fft.ifft.html#mlx.core.fft.ifft "mlx.core.fft.ifft")(a\\\\\\\\\\\\\\\[, n, axis, stream\\\\\\\\\\\\\\\]) | One dimensional inverse discrete Fourier Transform. | | \\\[\\\`\\\`fft2\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fft.fft2.html#mlx.core.fft.fft2 "mlx.core.fft.fft2")(a\\\\\\\\\\\\\\\[, s, axes, stream\\\\\\\\\\\\\\\]) | Two dimensional discrete Fourier Transform. | | \\\[\\\`\\\`ifft2\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fft.ifft2.html#mlx.core.fft.ifft2 "mlx.core.fft.ifft2")(a\\\\\\\\\\\\\\\[, s, axes, stream\\\\\\\\\\\\\\\]) | Two dimensional inverse discrete Fourier Transform. | | \\\[\\\`\\\`fftn\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fft.fftn.html#mlx.core.fft.fftn "mlx.core.fft.fftn")(a\\\\\\\\\\\\\\\[, s, axes, stream\\\\\\\\\\\\\\\]) | n-dimensional discrete Fourier Transform. | | \\\[\\\`\\\`ifftn\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fft.ifftn.html#mlx.core.fft.ifftn "mlx.core.fft.ifftn")(a\\\\\\\\\\\\\\\[, s, axes, stream\\\\\\\\\\\\\\\]) | n-dimensional inverse discrete Fourier Transform. | | \\\[\\\`\\\`rfft\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fft.rfft.html#mlx.core.fft.rfft "mlx.core.fft.rfft")(a\\\\\\\\\\\\\\\[, n, axis, stream\\\\\\\\\\\\\\\]) | One dimensional discrete Fourier Transform on a real input. | | \\\[\\\`\\\`irfft\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fft.irfft.html#mlx.core.fft.irfft "mlx.core.fft.irfft")(a\\\\\\\\\\\\\\\[, n, axis, stream\\\\\\\\\\\\\\\]) | The inverse of \\\[\\\`\\\`rfft()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fft.rfft.html#mlx.core.fft.rfft "mlx.core.fft.rfft"). | | \\\[\\\`\\\`rfft2\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fft.rfft2.html#mlx.core.fft.rfft2 "mlx.core.fft.rfft2")(a\\\\\\\\\\\\\\\[, s, axes, stream\\\\\\\\\\\\\\\]) | Two dimensional real discrete Fourier Transform. | | \\\[\\\`\\\`irfft2\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fft.irfft2.html#mlx.core.fft.irfft2 "mlx.core.fft.irfft2")(a\\\\\\\\\\\\\\\[, s, axes, stream\\\\\\\\\\\\\\\]) | The inverse of \\\[\\\`\\\`rfft2()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fft.rfft2.html#mlx.core.fft.rfft2 "mlx.core.fft.rfft2"). | | \\\[\\\`\\\`rfftn\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fft.rfftn.html#mlx.core.fft.rfftn "mlx.core.fft.rfftn")(a\\\\\\\\\\\\\\\[, s, axes, stream\\\\\\\\\\\\\\\]) | n-dimensional real discrete Fourier Transform. | | \\\[\\\`\\\`irfftn\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fft.irfftn.html#mlx.core.fft.irfftn "mlx.core.fft.irfftn")(a\\\\\\\\\\\\\\\[, s, axes, stream\\\\\\\\\\\\\\\]) | The inverse of \\\[\\\`\\\`rfftn()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fft.rfftn.html#mlx.core.fft.rfftn "mlx.core.fft.rfftn"). | \\\[\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fast.metal\\\_kernel.html "previous page") previous mlx.core.fast.metal\\\\\\\_kernel \\\[\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.fft.fft.html "next page") next mlx.core.fft.fft By MLX Contributors © Copyright 2023, MLX Contributors.

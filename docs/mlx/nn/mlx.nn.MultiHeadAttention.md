Curator's note: Prefer the human-authored MLX guides for clarity. - ../docs\\\\\\\_curated/README.md - ../docs\\\\\\\_curated/PYTORCH\\\\\\\_DISSONANCE.md - ../docs\\\\\\\_curated/NUMPY\\\\\\\_USERS.md - ../docs\\\\\\\_curated/COMMON\\\\\\\_PITFALLS.md \\\[\\\](https://github.com/ml-explore/mlx "Source repository")\\\\- \\\[.rst\\\](https://ml-explore.github.io/mlx/build/html/\\\_sources/python/nn/\\\_autosummary/mlx.nn.MultiHeadAttention.rst "Download source file") - .pdf # mlx.nn.MultiHeadAttention ## Contents \\\\- \\\[\\\`\\\`MultiHeadAttention\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/#mlx.nn.MultiHeadAttention) # mlx.nn.MultiHeadAttention \\\\\\\*\\\`class\\\` \\\\\\\*\\\`MultiHeadAttention\\\`(\\\\\\\*\\\`dims\\\`\\\`:\\\` \\\[\\\`int\\\`\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")\\\\\\\*, \\\\\\\*\\\`num\\\\\\\_heads\\\`\\\`:\\\` \\\[\\\`int\\\`\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")\\\\\\\*, \\\\\\\*\\\`query\\\\\\\_input\\\\\\\_dims\\\`\\\`:\\\` \\\[\\\`int\\\`\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)") \\\`\\\\\\\\|\\\` \\\[\\\`None\\\`\\\](https://docs.python.org/3/library/constants.html#None "(in Python v3.13)") \\\`\\\\=\\\` \\\`None\\\`\\\\\\\*, \\\\\\\*\\\`key\\\\\\\_input\\\\\\\_dims\\\`\\\`:\\\` \\\[\\\`int\\\`\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)") \\\`\\\\\\\\|\\\` \\\[\\\`None\\\`\\\](https://docs.python.org/3/library/constants.html#None "(in Python v3.13)") \\\`\\\\=\\\` \\\`None\\\`\\\\\\\*, \\\\\\\*\\\`value\\\\\\\_input\\\\\\\_dims\\\`\\\`:\\\` \\\[\\\`int\\\`\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)") \\\`\\\\\\\\|\\\` \\\[\\\`None\\\`\\\](https://docs.python.org/3/library/constants.html#None "(in Python v3.13)") \\\`\\\\=\\\` \\\`None\\\`\\\\\\\*, \\\\\\\*\\\`value\\\\\\\_dims\\\`\\\`:\\\` \\\[\\\`int\\\`\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)") \\\`\\\\\\\\|\\\` \\\[\\\`None\\\`\\\](https://docs.python.org/3/library/constants.html#None "(in Python v3.13)") \\\`\\\\=\\\` \\\`None\\\`\\\\\\\*, \\\\\\\*\\\`value\\\\\\\_output\\\\\\\_dims\\\`\\\`:\\\` \\\[\\\`int\\\`\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)") \\\`\\\\\\\\|\\\` \\\[\\\`None\\\`\\\](https://docs.python.org/3/library/constants.html#None "(in Python v3.13)") \\\`\\\\=\\\` \\\`None\\\`\\\\\\\*, \\\\\\\*\\\`bias\\\`\\\`:\\\` \\\[\\\`bool\\\`\\\](https://docs.python.org/3/library/functions.html#bool "(in Python v3.13)") \\\`\\\\=\\\` \\\`False\\\`\\\\\\\*) Implements the scaled dot product attention with multiple heads. Given inputs for queries, keys and values the \\\`\\\\\\\`MultiHeadAttention\\\\\\\`\\\` produces new values by aggregating information from the input values according to the similarities of the input queries and keys. All inputs as well as the output are linearly projected without biases by default. \\\`\\\\\\\`MultiHeadAttention\\\\\\\`\\\` also takes an optional additive attention mask that should be broadcastable with \\\`\\\\\\\`(batch,\\\\\\\`\\\`\\\\\\\` \\\\\\\`\\\`\\\\\\\`num\\\\\\\_heads,\\\\\\\`\\\`\\\\\\\` \\\\\\\`\\\`\\\\\\\`#\\\\\\\`\\\`\\\\\\\` \\\\\\\`\\\`\\\\\\\`queries,\\\\\\\`\\\`\\\\\\\` \\\\\\\`\\\`\\\\\\\`#\\\\\\\`\\\`\\\\\\\` \\\\\\\`\\\`\\\\\\\`keys)\\\\\\\`\\\`. The mask should have \\\`\\\\\\\`-inf\\\\\\\`\\\` or very large negative numbers at the positions that should \\\\\\\*not\\\\\\\* be attended to. Parameters: - \\\\\\\*\\\\\\\*dims\\\\\\\*\\\\\\\* (\\\[\\\*int\\\*\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")) – The model dimensions. This is also the default value for the queries, keys, values, and the output. - \\\\\\\*\\\\\\\*num\\\\\\\_heads\\\\\\\*\\\\\\\* (\\\[\\\*int\\\*\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")) – The number of attention heads to use. - \\\\\\\*\\\\\\\*query\\\\\\\_input\\\\\\\_dims\\\\\\\*\\\\\\\* (\\\[\\\*int\\\*\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")\\\\\\\*,\\\\\\\* \\\\\\\*optional\\\\\\\*) – The input dimensions of the queries. Default: \\\`\\\\\\\`dims\\\\\\\`\\\`. - \\\\\\\*\\\\\\\*key\\\\\\\_input\\\\\\\_dims\\\\\\\*\\\\\\\* (\\\[\\\*int\\\*\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")\\\\\\\*,\\\\\\\* \\\\\\\*optional\\\\\\\*) – The input dimensions of the keys. Default: \\\`\\\\\\\`dims\\\\\\\`\\\`. - \\\\\\\*\\\\\\\*value\\\\\\\_input\\\\\\\_dims\\\\\\\*\\\\\\\* (\\\[\\\*int\\\*\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")\\\\\\\*,\\\\\\\* \\\\\\\*optional\\\\\\\*) – The input dimensions of the values. Default: \\\`\\\\\\\`key\\\\\\\_input\\\\\\\_dims\\\\\\\`\\\`. - \\\\\\\*\\\\\\\*value\\\\\\\_dims\\\\\\\*\\\\\\\* (\\\[\\\*int\\\*\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")\\\\\\\*,\\\\\\\* \\\\\\\*optional\\\\\\\*) – The dimensions of the values after the projection. Default: \\\`\\\\\\\`dims\\\\\\\`\\\`. - \\\\\\\*\\\\\\\*value\\\\\\\_output\\\\\\\_dims\\\\\\\*\\\\\\\* (\\\[\\\*int\\\*\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")\\\\\\\*,\\\\\\\* \\\\\\\*optional\\\\\\\*) – The dimensions the new values will be projected to. Default: \\\`\\\\\\\`dims\\\\\\\`\\\`. - \\\\\\\*\\\\\\\*bias\\\\\\\*\\\\\\\* (\\\[\\\*bool\\\*\\\](https://docs.python.org/3/library/functions.html#bool "(in Python v3.13)")\\\\\\\*,\\\\\\\* \\\\\\\*optional\\\\\\\*) – Whether or not to use a bias in the projections. Default: \\\`\\\\\\\`False\\\\\\\`\\\`. Methods | | | |----------------------------------------------------------------------|-----| | \\\`\\\\\\\`create\\\\\\\_additive\\\\\\\_causal\\\\\\\_mask\\\\\\\`\\\`(N\\\\\\\\\\\\\\\[, dtype\\\\\\\\\\\\\\\]) | | \\\[\\\](https://ml-explore.github.io/mlx/build/html/python/nn/\\\_autosummary/mlx.nn.Mish.html "previous page") previous mlx.nn.Mish \\\[\\\](https://ml-explore.github.io/mlx/build/html/python/nn/\\\_autosummary/mlx.nn.PReLU.html "next page") next mlx.nn.PReLU Contents \\\\- \\\[\\\`\\\`MultiHeadAttention\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/#mlx.nn.MultiHeadAttention) By MLX Contributors © Copyright 2023, MLX Contributors.

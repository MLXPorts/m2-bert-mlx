Curator's note: Prefer the human-authored MLX guides for clarity. - ../docs\\\\\\\_curated/README.md - ../docs\\\\\\\_curated/PYTORCH\\\\\\\_DISSONANCE.md - ../docs\\\\\\\_curated/NUMPY\\\\\\\_USERS.md - ../docs\\\\\\\_curated/COMMON\\\\\\\_PITFALLS.md \\\[\\\](https://github.com/ml-explore/mlx "Source repository")\\\\- \\\[.rst\\\](https://ml-explore.github.io/mlx/build/html/\\\_sources/python/nn/\\\_autosummary/mlx.nn.GRU.rst "Download source file") - .pdf # mlx.nn.GRU ## Contents \\\\- \\\[\\\`\\\`GRU\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/#mlx.nn.GRU) # mlx.nn.GRU \\\\\\\*\\\`class\\\` \\\\\\\*\\\`GRU\\\`(\\\\\\\*\\\`input\\\\\\\_size\\\`\\\`:\\\` \\\[\\\`int\\\`\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")\\\\\\\*, \\\\\\\*\\\`hidden\\\\\\\_size\\\`\\\`:\\\` \\\[\\\`int\\\`\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")\\\\\\\*, \\\\\\\*\\\`bias\\\`\\\`:\\\` \\\[\\\`bool\\\`\\\](https://docs.python.org/3/library/functions.html#bool "(in Python v3.13)") \\\`\\\\=\\\` \\\`True\\\`\\\\\\\*) A gated recurrent unit (GRU) RNN layer. The input has shape \\\`\\\\\\\`NLD\\\\\\\`\\\` or \\\`\\\\\\\`LD\\\\\\\`\\\` where: - \\\`\\\\\\\`N\\\\\\\`\\\` is the optional batch dimension - \\\`\\\\\\\`L\\\\\\\`\\\` is the sequence length - \\\`\\\\\\\`D\\\\\\\`\\\` is the input’s feature dimension Concretely, for each element of the sequence, this layer computes: \\\\\\\\\\\\\\\\\\\\\\\\begin{split}\\\\\\\\begin{aligned} r\\\\\\\_t &= \\\\\\\\sigma (W\\\\\\\\\\\\\\\_{xr}x\\\\\\\_t + W\\\\\\\\\\\\\\\_{hr}h\\\\\\\_t + b\\\\\\\\\\\\\\\_{r}) \\\\\\\\\\\\\\\\ z\\\\\\\_t &= \\\\\\\\sigma (W\\\\\\\\\\\\\\\_{xz}x\\\\\\\_t + W\\\\\\\\\\\\\\\_{hz}h\\\\\\\_t + b\\\\\\\\\\\\\\\_{z}) \\\\\\\\\\\\\\\\ n\\\\\\\_t &= \\\\\\\\text{tanh}(W\\\\\\\\\\\\\\\_{xn}x\\\\\\\_t + b\\\\\\\\\\\\\\\_{n} + r\\\\\\\_t \\\\\\\\odot (W\\\\\\\\\\\\\\\_{hn}h\\\\\\\_t + b\\\\\\\\\\\\\\\_{hn})) \\\\\\\\\\\\\\\\ h\\\\\\\\\\\\\\\_{t + 1} &= (1 - z\\\\\\\_t) \\\\\\\\odot n\\\\\\\_t + z\\\\\\\_t \\\\\\\\odot h\\\\\\\_t \\\\\\\\end{aligned}\\\\\\\\end{split}\\\\\\\\\\\\\\\\ The hidden state \\\\\\\\\\\\\\\\h\\\\\\\\\\\\\\\\ has shape \\\`\\\\\\\`NH\\\\\\\`\\\` or \\\`\\\\\\\`H\\\\\\\`\\\` depending on whether the input is batched or not. Returns the hidden state at each time step of shape \\\`\\\\\\\`NLH\\\\\\\`\\\` or \\\`\\\\\\\`LH\\\\\\\`\\\`. Parameters: - \\\\\\\*\\\\\\\*input\\\\\\\_size\\\\\\\*\\\\\\\* (\\\[\\\*int\\\*\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")) – Dimension of the input, \\\`\\\\\\\`D\\\\\\\`\\\`. - \\\\\\\*\\\\\\\*hidden\\\\\\\_size\\\\\\\*\\\\\\\* (\\\[\\\*int\\\*\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")) – Dimension of the hidden state, \\\`\\\\\\\`H\\\\\\\`\\\`. - \\\\\\\*\\\\\\\*bias\\\\\\\*\\\\\\\* (\\\[\\\*bool\\\*\\\](https://docs.python.org/3/library/functions.html#bool "(in Python v3.13)")) – Whether to use biases or not. Default: \\\`\\\\\\\`True\\\\\\\`\\\`. Methods \\\[\\\](https://ml-explore.github.io/mlx/build/html/python/nn/\\\_autosummary/mlx.nn.GroupNorm.html "previous page") previous mlx.nn.GroupNorm \\\[\\\](https://ml-explore.github.io/mlx/build/html/python/nn/\\\_autosummary/mlx.nn.HardShrink.html "next page") next mlx.nn.HardShrink Contents \\\\- \\\[\\\`\\\`GRU\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/#mlx.nn.GRU) By MLX Contributors © Copyright 2023, MLX Contributors.

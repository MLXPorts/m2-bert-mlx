Curator's note: Prefer the human-authored MLX guides for clarity. - ../docs\\\\\\\_curated/README.md - ../docs\\\\\\\_curated/PYTORCH\\\\\\\_DISSONANCE.md - ../docs\\\\\\\_curated/NUMPY\\\\\\\_USERS.md - ../docs\\\\\\\_curated/COMMON\\\\\\\_PITFALLS.md \\\[\\\](https://github.com/ml-explore/mlx "Source repository")\\\\- \\\[.rst\\\](https://ml-explore.github.io/mlx/build/html/\\\_sources/python/\\\_autosummary/mlx.utils.tree\\\_map\\\_with\\\_path.rst "Download source file") - .pdf # mlx.utils.tree\\\\\\\_map\\\\\\\_with\\\\\\\_path ## Contents \\\\- \\\[\\\`\\\`tree\\\_map\\\_with\\\_path()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/#mlx.utils.tree\\\_map\\\_with\\\_path) # mlx.utils.tree\\\\\\\_map\\\\\\\_with\\\\\\\_path \\\`tree\\\\\\\_map\\\\\\\_with\\\\\\\_path\\\`(\\\\\\\*\\\`fn\\\`\\\`:\\\` \\\[\\\`Callable\\\`\\\](https://docs.python.org/3/library/typing.html#typing.Callable "(in Python v3.13)")\\\\\\\*, \\\\\\\*\\\`tree\\\`\\\`:\\\` \\\[\\\`Any\\\`\\\](https://docs.python.org/3/library/typing.html#typing.Any "(in Python v3.13)")\\\\\\\*, \\\\\\\*\\\`\\\\\\\\\\\\\\\*\\\`\\\`rest\\\`\\\`:\\\` \\\[\\\`Any\\\`\\\](https://docs.python.org/3/library/typing.html#typing.Any "(in Python v3.13)")\\\\\\\*, \\\\\\\*\\\`is\\\\\\\_leaf\\\`\\\`:\\\` \\\[\\\`Callable\\\`\\\](https://docs.python.org/3/library/typing.html#typing.Callable "(in Python v3.13)") \\\`\\\\\\\\|\\\` \\\[\\\`None\\\`\\\](https://docs.python.org/3/library/constants.html#None "(in Python v3.13)") \\\`\\\\=\\\` \\\`None\\\`\\\\\\\*, \\\\\\\*\\\`path\\\`\\\`:\\\` \\\[\\\`Any\\\`\\\](https://docs.python.org/3/library/typing.html#typing.Any "(in Python v3.13)") \\\`\\\\\\\\|\\\` \\\[\\\`None\\\`\\\](https://docs.python.org/3/library/constants.html#None "(in Python v3.13)") \\\`\\\\=\\\` \\\`None\\\`\\\\\\\*) → \\\[\\\`Any\\\`\\\](https://docs.python.org/3/library/typing.html#typing.Any "(in Python v3.13)") Applies \\\`\\\\\\\`fn\\\\\\\`\\\` to the path and leaves of the Python tree \\\`\\\\\\\`tree\\\\\\\`\\\` and returns a new collection with the results. This function is the same \\\[\\\`\\\`tree\\\_map()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.utils.tree\\\_map.html#mlx.utils.tree\\\_map "mlx.utils.tree\\\_map") but the \\\`\\\\\\\`fn\\\\\\\`\\\` takes the path as the first argument followed by the remaining tree nodes. Parameters: - \\\\\\\*\\\\\\\*fn\\\\\\\*\\\\\\\* (\\\\\\\*callable\\\\\\\*) – The function that processes the leaves of the tree. - \\\\\\\*\\\\\\\*tree\\\\\\\*\\\\\\\* (\\\\\\\*Any\\\\\\\*) – The main Python tree that will be iterated upon. - \\\\\\\*\\\\\\\*rest\\\\\\\*\\\\\\\* (\\\[\\\*tuple\\\*\\\](https://docs.python.org/3/library/stdtypes.html#tuple "(in Python v3.13)")\\\\\\\*\\\\\\\\\\\\\\\[Any\\\\\\\\\\\\\\\]\\\\\\\*) – Extra trees to be iterated together with \\\`\\\\\\\`tree\\\\\\\`\\\`. - \\\\\\\*\\\\\\\*is\\\\\\\_leaf\\\\\\\*\\\\\\\* (\\\\\\\*Optional\\\\\\\\\\\\\\\[Callable\\\\\\\\\\\\\\\]\\\\\\\*) – An optional callable that returns \\\`\\\\\\\`True\\\\\\\`\\\` if the passed object is considered a leaf or \\\`\\\\\\\`False\\\\\\\`\\\` otherwise. - \\\\\\\*\\\\\\\*path\\\\\\\*\\\\\\\* (\\\\\\\*Optional\\\\\\\\\\\\\\\[Any\\\\\\\\\\\\\\\]\\\\\\\*) – Prefix will be added to the result. Returns: A Python tree with the new values returned by \\\`\\\\\\\`fn\\\\\\\`\\\`. Example \\\\>>> from mlx.utils import tree\\\\\\\_map\\\\\\\_with\\\\\\\_path >>> tree = {"model": \\\\\\\[{"w": 0, "b": 1}, {"w": 0, "b": 1}\\\\\\\]} >>> new\\\\\\\_tree = tree\\\\\\\_map\\\\\\\_with\\\\\\\_path(lambda path, \\\\\\\_: print(path), tree) model.0.w model.0.b model.1.w model.1.b \\\[\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.utils.tree\\\_map.html "previous page") previous mlx.utils.tree\\\\\\\_map \\\[\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.utils.tree\\\_reduce.html "next page") next mlx.utils.tree\\\\\\\_reduce Contents \\\\- \\\[\\\`\\\`tree\\\_map\\\_with\\\_path()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/#mlx.utils.tree\\\_map\\\_with\\\_path) By MLX Contributors © Copyright 2023, MLX Contributors.

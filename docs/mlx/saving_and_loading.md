Curator's note: Prefer the human-authored MLX guides for clarity. - ../docs\\\\\\\_curated/README.md - ../docs\\\\\\\_curated/PYTORCH\\\\\\\_DISSONANCE.md - ../docs\\\\\\\_curated/NUMPY\\\\\\\_USERS.md - ../docs\\\\\\\_curated/COMMON\\\\\\\_PITFALLS.md \\\[\\\](https://github.com/ml-explore/mlx "Source repository")\\\\- \\\[.rst\\\](https://ml-explore.github.io/mlx/build/html/\\\_sources/usage/saving\\\_and\\\_loading.rst "Download source file") - .pdf # Saving and Loading Arrays # Saving and Loading Arrays MLX supports multiple array serialization formats. | Format | Extension | Function | Notes | |----|----|----|----| | NumPy | \\\`\\\\\\\`.npy\\\\\\\`\\\` | \\\[\\\`\\\`save()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.save.html#mlx.core.save "mlx.core.save") | Single arrays only | | NumPy archive | \\\`\\\\\\\`.npz\\\\\\\`\\\` | \\\[\\\`\\\`savez()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.savez.html#mlx.core.savez "mlx.core.savez") and \\\[\\\`\\\`savez\\\_compressed()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.savez\\\_compressed.html#mlx.core.savez\\\_compressed "mlx.core.savez\\\_compressed") | Multiple arrays | | Safetensors | \\\`\\\\\\\`.safetensors\\\\\\\`\\\` | \\\[\\\`\\\`save\\\_safetensors()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.save\\\_safetensors.html#mlx.core.save\\\_safetensors "mlx.core.save\\\_safetensors") | Multiple arrays | | GGUF | \\\`\\\\\\\`.gguf\\\\\\\`\\\` | \\\[\\\`\\\`save\\\_gguf()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.save\\\_gguf.html#mlx.core.save\\\_gguf "mlx.core.save\\\_gguf") | Multiple arrays | Serialization Formats {#id1} The \\\[\\\`\\\`load()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.load.html#mlx.core.load "mlx.core.load") function will load any of the supported serialization formats. It determines the format from the extensions. The output of \\\[\\\`\\\`load()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.load.html#mlx.core.load "mlx.core.load") depends on the format. Here’s an example of saving a single array to a file: \\\`\\\`\\\`shell > a = mx.array(\\\[1.0\\\]) > mx.save("array", a) \\\`\\\`\\\` The array \\\`\\\\\\\`a\\\\\\\`\\\` will be saved in the file \\\`\\\\\\\`array.npy\\\\\\\`\\\` (notice the extension is automatically added). Including the extension is optional; if it is missing it will be added. You can load the array with: \\\`\\\`\\\`shell > mx.load("array.npy") array(\\\[1\\\], dtype=float32) \\\`\\\`\\\` Here’s an example of saving several arrays to a single file: \\\`\\\`\\\`shell > a = mx.array(\\\[1.0\\\]) > b = mx.array(\\\[2.0\\\]) > mx.savez("arrays", a, b=b) \\\`\\\`\\\` For compatibility with \\\[\\\`\\\`numpy.savez()\\\`\\\`\\\](https://numpy.org/doc/stable/reference/generated/numpy.savez.html#numpy.savez "(in NumPy v2.2)") the MLX \\\[\\\`\\\`savez()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.savez.html#mlx.core.savez "mlx.core.savez") takes arrays as arguments. If the keywords are missing, then default names will be provided. This can be loaded with: \\\`\\\`\\\`shell > mx.load("arrays.npz") {'b': array(\\\[2\\\], dtype=float32), 'arr\\\_0': array(\\\[1\\\], dtype=float32)} \\\`\\\`\\\` In this case \\\[\\\`\\\`load()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.load.html#mlx.core.load "mlx.core.load") returns a dictionary of names to arrays. The functions \\\[\\\`\\\`save\\\_safetensors()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.save\\\_safetensors.html#mlx.core.save\\\_safetensors "mlx.core.save\\\_safetensors") and \\\[\\\`\\\`save\\\_gguf()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.save\\\_gguf.html#mlx.core.save\\\_gguf "mlx.core.save\\\_gguf") are similar to \\\[\\\`\\\`savez()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.savez.html#mlx.core.savez "mlx.core.savez"), but they take as input a \\\[\\\`\\\`dict\\\`\\\`\\\](https://docs.python.org/3/library/stdtypes.html#dict "(in Python v3.13)") of string names to arrays: \\\`\\\`\\\`shell > a = mx.array(\\\[1.0\\\]) > b = mx.array(\\\[2.0\\\]) > mx.save\\\_safetensors("arrays", {"a": a, "b": b}) \\\`\\\`\\\` \\\[\\\](https://ml-explore.github.io/mlx/build/html/usage/indexing.html "previous page") previous Indexing Arrays \\\[\\\](https://ml-explore.github.io/mlx/build/html/usage/function\\\_transforms.html "next page") next Function Transforms By MLX Contributors © Copyright 2023, MLX Contributors.

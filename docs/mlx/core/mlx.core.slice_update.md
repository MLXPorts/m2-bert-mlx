Curator's note: Prefer the human-authored MLX guides for clarity. - ../docs\\\\\\\_curated/README.md - ../docs\\\\\\\_curated/PYTORCH\\\\\\\_DISSONANCE.md - ../docs\\\\\\\_curated/NUMPY\\\\\\\_USERS.md - ../docs\\\\\\\_curated/COMMON\\\\\\\_PITFALLS.md \\\\## Curated Notes - Arg types: \\\\\\\`start\\\\\\\_indices\\\\\\\` is MLX array; \\\\\\\`axes\\\\\\\` is Python list/tuple; \\\\\\\`update\\\\\\\` is an MLX array matching the target region shape. - No \\\\\\\`device=\\\\\\\` argument: control device via default device, scoped context, or per‑op \\\\\\\`stream\\\\\\\`. - Relation to Python slicing: MLX is functional; this op returns a new array. There is no in‑place \\\\\\\`a\\\\\\\[slc\\\\\\\] = ...\\\\\\\` mutation. - Relation to \\\\\\\`array.at\\\\\\\[...\\\\\\\]\\\\\\\`: \\\\\\\`a.at\\\\\\\[slc\\\\\\\].set(update)\\\\\\\` is the idiomatic syntax sugar for simple slice replacement. - Boolean masks: use \\\\\\\`mx.where\\\\\\\` for conditional updates; \\\\\\\`.at\\\\\\\[...\\\\\\\]\\\\\\\` does not accept boolean masks. ### Examples \\\\\\\`\\\\\\\`\\\\\\\`python import mlx.core as mx a = mx.arange(12).reshape(3, 4) upd = mx.array(\\\\\\\[\\\\\\\[10, 11\\\\\\\], \\\\\\\[12, 13\\\\\\\]\\\\\\\]) start = mx.array(\\\\\\\[0, 1\\\\\\\]) axes = \\\\\\\[0, 1\\\\\\\] b = mx.slice\\\\\\\_update(a, upd, start, axes) # \\\\\\\[\\\\\\\[ 0,10,11, 3\\\\\\\], # \\\\\\\[ 4,12,13, 7\\\\\\\], # \\\\\\\[ 8, 9,10,11\\\\\\\]\\\\\\\] # CPU route b\\\\\\\_cpu = mx.slice\\\\\\\_update(a, upd, start, axes, stream=mx.cpu) # Equivalent using .at c = a.at\\\\\\\[0:2, 1:3\\\\\\\].set(upd) # Conditional update via where (boolean mask) mask = a > 6 d = mx.where(mask, 0, a) # zero out elements > 6 \\\\\\\`\\\\\\\`\\\\\\\` \\\[\\\](https://github.com/ml-explore/mlx "Source repository")\\\\- \\\[.rst\\\](https://ml-explore.github.io/mlx/build/html/\\\_sources/python/\\\_autosummary/mlx.core.slice\\\_update.rst "Download source file") - .pdf # mlx.core.slice\\\\\\\_update ## Contents \\\\- \\\[\\\`\\\`slice\\\_update()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/#mlx.core.slice\\\_update) # mlx.core.slice\\\\\\\_update \\\`slice\\\\\\\_update\\\`(\\\\\\\*\\\`a\\\`\\\`:\\\` \\\[\\\`array\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.array.html#mlx.core.array "mlx.core.array")\\\\\\\*, \\\\\\\*\\\`update\\\`\\\`:\\\` \\\[\\\`array\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.array.html#mlx.core.array "mlx.core.array")\\\\\\\*, \\\\\\\*\\\`start\\\\\\\_indices\\\`\\\`:\\\` \\\[\\\`array\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.array.html#mlx.core.array "mlx.core.array")\\\\\\\*, \\\\\\\*\\\`axes\\\`\\\`:\\\` \\\`Sequence\\\`\\\`\\\\\\\\\\\\\\\[\\\`\\\[\\\`int\\\`\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")\\\`\\\\\\\\\\\\\\\]\\\`\\\\\\\*, \\\\\\\*\\\`\\\\\\\\\\\\\\\*\\\`\\\\\\\*, \\\\\\\*\\\`stream\\\`\\\`:\\\` \\\[\\\`None\\\`\\\](https://docs.python.org/3/library/constants.html#None "(in Python v3.13)") \\\`\\\\\\\\|\\\` \\\[\\\`Stream\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/stream\\\_class.html#mlx.core.Stream "mlx.core.Stream") \\\`\\\\\\\\|\\\` \\\[\\\`Device\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.Device.html#mlx.core.Device "mlx.core.Device") \\\`\\\\=\\\` \\\`None\\\`\\\\\\\*) → \\\[\\\`array\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.array.html#mlx.core.array "mlx.core.array") Update a sub-array of the input array. Parameters: - \\\\\\\*\\\\\\\*a\\\\\\\*\\\\\\\* (\\\[\\\*array\\\*\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.array.html#mlx.core.array "mlx.core.array")) – The input array to update - \\\\\\\*\\\\\\\*update\\\\\\\*\\\\\\\* (\\\[\\\*array\\\*\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.array.html#mlx.core.array "mlx.core.array")) – The update array. - \\\\\\\*\\\\\\\*start\\\\\\\_indices\\\\\\\*\\\\\\\* (\\\[\\\*array\\\*\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.array.html#mlx.core.array "mlx.core.array")) – The index location to start the slice at. - \\\\\\\*\\\\\\\*axes\\\\\\\*\\\\\\\* (\\\[\\\*tuple\\\*\\\](https://docs.python.org/3/library/stdtypes.html#tuple "(in Python v3.13)")\\\\\\\*(\\\\\\\*\\\[\\\*int\\\*\\\](https://docs.python.org/3/library/functions.html#int "(in Python v3.13)")\\\\\\\*)\\\\\\\*) – The axes corresponding to the indices in \\\`\\\\\\\`start\\\\\\\_indices\\\\\\\`\\\`. Returns: The output array with the same shape and type as the input. Return type: \\\[\\\*array\\\*\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.array.html#mlx.core.array "mlx.core.array") Example \\\\>>> a = mx.zeros((3, 3)) >>> mx.slice\\\\\\\_update(a, mx.ones((1, 2)), start\\\\\\\_indices=mx.array(1, 1), axes=(0, 1)) array(\\\\\\\[\\\\\\\[0, 0, 0\\\\\\\], \\\\\\\[0, 1, 0\\\\\\\], \\\\\\\[0, 1, 0\\\\\\\]\\\\\\\], dtype=float32) \\\[\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.slice.html "previous page") previous mlx.core.slice \\\[\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.softmax.html "next page") next mlx.core.softmax Contents \\\\- \\\[\\\`\\\`slice\\\_update()\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/#mlx.core.slice\\\_update) By MLX Contributors © Copyright 2023, MLX Contributors.

Curator's note: Prefer the human-authored MLX guides for clarity. - ../docs\\\\\\\_curated/README.md - ../docs\\\\\\\_curated/PYTORCH\\\\\\\_DISSONANCE.md - ../docs\\\\\\\_curated/NUMPY\\\\\\\_USERS.md - ../docs\\\\\\\_curated/COMMON\\\\\\\_PITFALLS.md \\\\## Curated Notes - Inspect placement: \\\\\\\`print(mx.default\\\\\\\_device())\\\\\\\`; scope with \\\\\\\`with mx.default\\\\\\\_device(mx.cpu): ...\\\\\\\`. - Stream contexts: \\\\\\\`with mx.new\\\\\\\_stream(): ...\\\\\\\` queue work; call \\\\\\\`mx.synchronize()\\\\\\\` before consuming results on host. - Prefer simple single‑stream usage first; add streams after profiling shows contention. - Note: MLX ops generally do not accept a \\\\\\\`device=\\\\\\\` keyword. Use the default device, a scoped \\\\\\\`with mx.default\\\\\\\_device(...)\\\\\\\`, a per‑op \\\\\\\`stream=...\\\\\\\`, or \\\\\\\`mx.set\\\\\\\_default\\\\\\\_device(...)\\\\\\\` to control placement. ### Examples ### Examples \\\\\\\`\\\\\\\`\\\\\\\`python import mlx.core as mx print(mx.default\\\\\\\_device()) # Run a block on CPU explicitly with mx.default\\\\\\\_device(mx.cpu): a = mx.ones((1024, 1024)) # Queue work on a new stream and sync before host use s = mx.new\\\\\\\_stream() with s: b = mx.random.normal((2048, 2048)) @ mx.random.normal((2048, 2048)) # Change default device globally (all subsequent ops) mx.set\\\\\\\_default\\\\\\\_device(mx.cpu) # Ensure work completed before converting to Python types / printing mx.synchronize() print(b.shape) \\\\\\\`\\\\\\\`\\\\\\\` \\\[\\\](https://github.com/ml-explore/mlx "Source repository")\\\\- \\\[.rst\\\](https://ml-explore.github.io/mlx/build/html/\\\_sources/python/devices\\\_and\\\_streams.rst "Download source file") - .pdf # Devices and Streams # Devices and Streams | | | |----|----| | \\\[\\\`\\\`Device\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.Device.html#mlx.core.Device "mlx.core.Device") | A device to run operations on. | | \\\[\\\`\\\`Stream\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/stream\\\_class.html#mlx.core.Stream "mlx.core.Stream") | A stream for running operations on a given device. | | \\\[\\\`\\\`default\\\_device\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.default\\\_device.html#mlx.core.default\\\_device "mlx.core.default\\\_device")() | Get the default device. | | \\\[\\\`\\\`set\\\_default\\\_device\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.set\\\_default\\\_device.html#mlx.core.set\\\_default\\\_device "mlx.core.set\\\_default\\\_device")(device) | Set the default device. | | \\\[\\\`\\\`default\\\_stream\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.default\\\_stream.html#mlx.core.default\\\_stream "mlx.core.default\\\_stream")(device) | Get the device's default stream. | | \\\[\\\`\\\`new\\\_stream\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.new\\\_stream.html#mlx.core.new\\\_stream "mlx.core.new\\\_stream")(device) | Make a new stream on the given device. | | \\\[\\\`\\\`set\\\_default\\\_stream\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.set\\\_default\\\_stream.html#mlx.core.set\\\_default\\\_stream "mlx.core.set\\\_default\\\_stream")(stream) | Set the default stream. | | \\\[\\\`\\\`stream\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.stream.html#mlx.core.stream "mlx.core.stream")(s) | Create a context manager to set the default device and stream. | | \\\[\\\`\\\`synchronize\\\`\\\`\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.synchronize.html#mlx.core.synchronize "mlx.core.synchronize")(\\\\\\\\\\\\\\\[stream\\\\\\\\\\\\\\\]) | Synchronize with the given stream. | \\\[\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.finfo.html "previous page") previous mlx.core.finfo \\\[\\\](https://ml-explore.github.io/mlx/build/html/python/\\\_autosummary/mlx.core.Device.html "next page") next mlx.core.Device By MLX Contributors © Copyright 2023, MLX Contributors.
